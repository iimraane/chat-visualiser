<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhatsApp Chat Viewer</title>
    <link rel="stylesheet" href="main.css">
</head>

<body>

    <!-- Upload Screen -->
    <div id="upload-screen" class="screen active">
        <div class="upload-card">
            <div class="whatsapp-icon">ğŸ’¬</div>
            <h1>WhatsApp Visualizer</h1>

            <div class="upload-section">
                <p><strong>1.</strong> Select your <code>_chat.txt</code></p>
                <label for="file-input" class="btn-upload">Choose Chat File</label>
                <input type="file" id="file-input" accept=".txt">
                <span id="chat-file-name" class="file-name"></span>
            </div>

            <div class="upload-section">
                <p><strong>2.</strong> Add media folder (optional)</p>
                <label for="media-input" class="btn-upload btn-secondary">Add Media Folder</label>
                <input type="file" id="media-input" webkitdirectory directory multiple>
                <span id="media-count" class="file-name"></span>
            </div>

            <button id="start-btn" class="btn-start" disabled>Visualize Chat</button>
            <p id="status" class="status"></p>
        </div>
    </div>

    <!-- Chat Screen -->
    <div id="chat-screen" class="screen">
        <div id="chat-background"></div>
        <div class="chat-header">
            <button id="back-btn" class="icon-btn">â†</button>
            <div class="header-info">
                <h2 id="chat-name">Chat</h2>
                <small id="participants-info"></small>
            </div>
            <button id="settings-btn" class="icon-btn">âš™ï¸</button>
        </div>

        <!-- Floating Date Pill -->
        <div id="floating-date" class="floating-date"></div>

        <div id="chat-area"></div>

        <div class="chat-footer">
            <div class="search-container">
                <span class="search-icon">ğŸ”</span>
                <input type="text" id="search-input" placeholder="Search messages or date...">
                <button id="search-clear" class="search-clear hidden">âœ•</button>
            </div>
            <div id="search-results" class="search-results hidden">
                <span id="search-count">0 results</span>
                <button id="search-prev" class="search-nav">â†‘</button>
                <button id="search-next" class="search-nav">â†“</button>
            </div>
        </div>
    </div>

    <!-- Settings Panel -->
    <div id="settings-panel" class="panel">
        <div class="panel-header">
            <h3>Settings</h3>
            <button id="close-settings" class="icon-btn">âœ•</button>
        </div>

        <div class="setting-group">
            <h4>Theme</h4>
            <button id="theme-btn" class="btn-setting">
                <span id="theme-icon">ğŸŒ™</span>
                <span id="theme-text">Dark Mode</span>
            </button>
        </div>

        <div class="setting-group">
            <h4>Viewpoint</h4>
            <p class="setting-desc">Messages from this person appear on the right</p>
            <select id="viewpoint-select" class="select-input">
                <option value="">Select person...</option>
            </select>
        </div>

        <div class="setting-group">
            <h4>Chat Background</h4>
            <p class="setting-desc">Customize your conversation background</p>
            <label for="bg-input" class="btn-setting" style="cursor: pointer; justify-content: center;">
                <span>ğŸ–¼ï¸</span>
                <span>Choose Image</span>
            </label>
            <input type="file" id="bg-input" accept="image/*" style="display: none;">
            <button id="bg-reset" class="btn-setting" style="margin-top: 8px; justify-content: center;">
                <span>ğŸ—‘ï¸</span>
                <span>Remove Background</span>
            </button>
        </div>

        <div class="setting-group" id="rename-section" style="display: none;">
            <h4>Renommer les participants</h4>
            <p class="setting-desc">Personnalise les noms affichÃ©s</p>
            <div id="rename-container" class="rename-container"></div>
        </div>

        <div class="setting-group" id="starred-section" style="display: none;">
            <h4>â­ Messages favoris</h4>
            <p class="setting-desc">Tes messages prÃ©fÃ©rÃ©s</p>
            <div id="starred-container" class="starred-container"></div>
            <p id="no-starred" class="no-starred">Aucun message favori. Appui long (mobile) ou clic droit (PC) sur un
                message pour l'ajouter.</p>
        </div>
    </div>

    <!-- Floating Heart Button -->
    <button id="predefined-btn" class="floating-heart-btn" title="Chat prÃ©dÃ©fini">ğŸ’•</button>

    <!-- Password Modal -->
    <div id="password-modal" class="modal-overlay hidden">
        <div class="modal-card">
            <div class="modal-emoji">ğŸ”</div>
            <h2>AccÃ¨s ProtÃ©gÃ©</h2>
            <p>Entre le mot de passe pour accÃ©der au chat secret</p>
            <input type="password" id="password-input" class="modal-input" placeholder="Mot de passe...">
            <p id="password-error" class="password-error hidden">Mot de passe incorrect ğŸ’”</p>
            <button id="password-submit" class="modal-btn">Valider</button>
        </div>
    </div>

    <!-- Love Popup Modal -->
    <div id="love-popup" class="modal-overlay hidden">
        <div class="love-popup-card">
            <div class="love-popup-emoji" id="love-popup-emoji">ğŸ’–</div>
            <p class="love-popup-text" id="love-popup-text">Message d'amour</p>
            <button id="love-popup-btn" class="love-popup-btn">Confirmer</button>
        </div>
    </div>

    <script src="confetti.js"></script>
    <script src="main.js"></script>
</body>

</html>